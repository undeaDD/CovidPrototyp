function signout(){firebase.auth().signOut()}function snapshotToArray(e){var a=[];return e.forEach(function(e){var t=e.val();t.id=e.key,a.push(t)}),a}function createEntry(){firebase.database().ref("cavities").once("value").then(e=>{var a=0;e.forEach(function(e){const t=parseInt(e.key);console.log(t),a=a<t?t:a}),console.log(a),firebase.database().ref("cavities/"+(a+1)).set({status:"In Bearbeitung",date4:(new Date).toLocaleDateString(),count:0})})}function viewMatrix(){$("select.bsselect").each(function(e){$(this).empty(),$(this).append("<optgroup label='Extras'><option title='⠀'>-</option><option>NK</option><option>PK</option></optgroup>");var a=$("<optgroup label='Patienten'>");$(this).append(a),a.append("<option title='C1234'>C1234 - Wiencek Isabeau</option>"),$(this).parent().hasClass("dropdown")?(console.log("refresh"),$(this).selectpicker("refresh")):(console.log("init"),$(this).selectpicker({maxOptions:!1,noneSelectedText:"⠀",liveSearch:!0,liveSearchNormalize:!0,liveSearchPlaceholder:"Suchen...",width:"100%"}))}),$("#matrixModal").modal({keyboard:!1,show:!0})}function testMatrix(){$("select.bsselect").each(function(e){$(this).empty(),$(this).append("<option title='-'>Negativ</option><option title='+'>Positiv</option>"),$(this).parent().hasClass("dropdown")?$(this).selectpicker("refresh"):$(this).selectpicker({header:"Ergebnis:",maxOptions:!1,noneSelectedText:"⠀",liveSearch:!1,width:"100%"})}),$("#matrixModal").modal({keyboard:!1,show:!0})}function removeEntry(e){confirm("Soll der Eintrag wirklich gelöscht werden?")&&firebase.database().ref(e).remove()}firebase.initializeApp({apiKey:"AIzaSyAKzR5AiJVZ3Iz5tJrWsLeBVDZJl2SSqLE",authDomain:"coronaprototyp.firebaseapp.com",databaseURL:"https://coronaprototyp.firebaseio.com",projectId:"coronaprototyp",storageBucket:"coronaprototyp.appspot.com",messagingSenderId:"857488715212",appId:"1:857488715212:web:763e73804d890e4bf40169"}),$(function(){$(window).resize(function(){$("#table3").DataTable().columns.adjust().draw(),$("#table3").DataTable().fixedHeader.adjust().draw()}),firebase.auth().onAuthStateChanged(function(e){e?(document.body.classList.remove("d-none"),firebase.database().ref("cavities").on("value",function(e){var a=snapshotToArray(e),t=$("#table3").DataTable({dom:"<'row'<'col-6 'B><'col-6'f>><'row'<'col-sm-12'tr>>",blurable:!1,destroy:!0,paging:!1,ordering:!0,info:!1,keys:!1,searching:!0,fixedHeader:!0,scrollX:!0,autoWidth:!1,order:[[1,"desc"]],language:{search:"",searchPlaceholder:"Nach Plan suchen",emptyTable:"Keine Kavitätenpläne vorhanden"},buttons:[{text:"<img height='21' class='mr-2' style='margin-top: -4px;' src='../assets/img/file-plus.png'/>Neuer Kavitätenplan",action:function(e,a,t,o){createEntry()},className:"customButton mr-2"}],columnDefs:[{width:"80px",targets:0}],columns:[{data:"actions",defaultContent:"",orderable:!1,searchable:!1,render:function(e,a,t,o){return"<a onclick='viewMatrix(\"cavities/"+t.id+"\")'><img class='mr-2' height='21' src='../assets/img/pencil.png'/></a><a onclick='removeEntry(\"cavities/"+t.id+"\")'><img class='mr-2' height='21' src='../assets/img/trash.png'/></a><a onclick='testMatrix(\"cavities/"+t.id+"\")'><img height='21' src='../assets/img/vial.png'/></a>"}},{data:"id",className:"bold",orderable:!0,searchable:!0},{data:"status",defaultContent:"In Bearbeitung",orderable:!0,searchable:!0},{data:"date4",defaultContent:"-",orderable:!0,searchable:!0},{data:"count",defaultContent:"0",orderable:!0,searchable:!0}],data:a});t.columns.adjust().draw(),t.fixedHeader.adjust().draw(),$("#count3").text(t.data().count())}),firebase.database().ref("patients").on("value",function(e){var a=snapshotToArray(e),t=$("#table4").DataTable({dom:"<'row'<'col-6 'B><'col-6'f>><'row'<'col-sm-12'tr>>",blurable:!1,destroy:!0,paging:!1,ordering:!0,info:!1,keys:!1,searching:!0,fixedHeader:!0,scrollX:!0,autoWidth:!1,order:[[1,"desc"]],language:{search:"",searchPlaceholder:"Nach Eintrag suchen",emptyTable:"Keine Einträge vorhanden"},buttons:[],columns:[{data:"id",className:"bold",orderable:!0},{data:"poolid",defaultContent:"-",orderable:!1,searchable:!0},{data:"lname",orderable:!1},{data:"fname",orderable:!1}],data:a});t.columns.adjust().draw(),t.fixedHeader.adjust().draw()})):(firebase.auth().signOut(),window.location.href="login.html")})});
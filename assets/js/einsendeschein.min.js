async function checkAndInsert(){var e=!0;const t=document.forms.main,n=[...t.elements];var i=n.reduce(function(t,n,i){return"date"==n.type?t[n.name]=n.valueAsDate.toLocaleDateString():""==n.value?n.classList.contains("required")&&(n.classList.add("is-invalid"),e=!1):(n.classList.remove("is-invalid"),t[n.name]=n.value),t},{});i.p1_telephone||i.p1_mobile||i.p1_fax||i.p1_email||(t.p1_telephone.classList.add("is-invalid"),e=!1);try{for(let e=1;e<6;e++){const n=t["p"+e+"_front"];n.files.length>0?i["p"+e+"_front"]=await readFile(n.files[0]):delete i["p"+e+"_front"];const a=t["p"+e+"_back"];a.files.length>0?i["p"+e+"_back"]=await readFile(a.files[0]):delete i["p"+e+"_back"]}}catch(e){}const a=document.getElementById("morePatients").selectedIndex;switch(a){case 3:delete i.p5_birthdate,delete i.p5_birthdate,delete i.p5_email_verify;break;case 2:delete i.p4_birthdate,delete i.p4_email_verify,delete i.p5_birthdate,delete i.p5_email_verify;break;case 1:delete i.p3_birthdate,delete i.p3_email_verify,delete i.p4_birthdate,delete i.p4_email_verify,delete i.p5_birthdate,delete i.p5_email_verify;break;default:i.morepatients="0",delete i.p2_birthdate,delete i.p2_email_verify,delete i.p3_birthdate,delete i.p3_email_verify,delete i.p4_birthdate,delete i.p4_email_verify,delete i.p5_birthdate,delete i.p5_email_verify}for(let n=1;n<6;n++)try{const a=i["p"+n+"_email_verify"];a&&(a!=i["p"+n+"_email"]?(t["p"+n+"_email_verify"].classList.add("is-invalid"),e=!1):delete i["p"+n+"_email_verify"])}catch(e){}if(t.invoice_enabled.checked?i.invoice_enabled=!0:i.invoice_enabled=!1,t.datenschutz.checked?i.datenschutz=!0:(i.datenschutz=!1,e=!1),i.signature=document.getElementById("sig-canvas").toDataURL(),i.insertDate=(new Date).toLocaleDateString(),i.OS=navigator.platform,console.log(i),e){const e=firebase.database().ref().child("requests").push().key;firebase.database().ref("requests/"+e).set(i),$("#successModal").modal("show")}else $("#errorModal").modal("show")}async function readFile(e){return await new Promise(t=>{let n=new FileReader;n.onload=(e=>t(n.result)),n.readAsDataURL(e)})}function toggleRechnung(){document.getElementById("cardRechnung").classList.toggle("d-none"),document.getElementsByName("invoice_firstname")[0].classList.toggle("required"),document.getElementsByName("invoice_street")[0].classList.toggle("required"),document.getElementsByName("invoice_zip")[0].classList.toggle("required"),document.getElementsByName("invoice_address")[0].classList.toggle("required"),document.getElementsByName("invoice_email")[0].classList.toggle("required")}function configurePatient(e,t){e?(document.getElementById("patient"+t).classList.remove("d-none"),document.getElementsByName("p"+t+"_firstname")[0].classList.add("required"),document.getElementsByName("p"+t+"_lastname")[0].classList.add("required"),document.getElementsByName("p"+t+"_street")[0].classList.add("required"),document.getElementsByName("p"+t+"_zip")[0].classList.add("required"),document.getElementsByName("p"+t+"_address")[0].classList.add("required"),document.getElementsByName("p"+t+"_birthdate")[0].classList.add("required")):(document.getElementById("patient"+t).classList.add("d-none"),document.getElementsByName("p"+t+"_firstname")[0].classList.remove("required"),document.getElementsByName("p"+t+"_lastname")[0].classList.remove("required"),document.getElementsByName("p"+t+"_street")[0].classList.remove("required"),document.getElementsByName("p"+t+"_zip")[0].classList.remove("required"),document.getElementsByName("p"+t+"_address")[0].classList.remove("required"),document.getElementsByName("p"+t+"_birthdate")[0].classList.remove("required"))}function showPatients(){const e=document.getElementById("morePatients").selectedIndex;switch(configurePatient(!1,2),configurePatient(!1,3),configurePatient(!1,4),configurePatient(!1,5),e){case 4:configurePatient(!0,5);case 3:configurePatient(!0,4);case 2:configurePatient(!0,3);case 1:configurePatient(!0,2)}}function toggleCC(){document.getElementById("copyMail").classList.toggle("d-none"),document.getElementById("copyMail").classList.contains("d-none")?document.getElementById("copyMailButton").innerText="+":document.getElementById("copyMailButton").innerText="-"}function updateLabel(e){var t=e.target.files[0].name;null!=e.target.nextElementSibling&&(e.target.nextElementSibling.innerText=t)}function googleTranslateElementInit(){new google.translate.TranslateElement({pageLanguage:"de"},"google_translate_element"),jQuery(".goog-logo-link").css("display","none"),jQuery(".goog-te-gadget").css("font-size","0")}function login(){$("#loginModal").modal("show")}function doLogin(){let e=document.getElementById("login_email").value,t=document.getElementById("login_password").value;return firebase.auth().signInWithEmailAndPassword(e,t).then(()=>{console.log("authenticated"),window.location.href="patients.html"}).catch(function(e){console.log(e)}),!1}window.addEventListener("resize",function(e){var t=document.getElementById("sig-canvas");t.width=t.offsetWidth});var canvas=document.getElementById("sig-canvas");canvas.width=canvas.offsetWidth,function(){function e(e,t){var n=e.getBoundingClientRect();return{x:t.clientX-n.left,y:t.clientY-n.top}}function t(e,t){var n=e.getBoundingClientRect();return{x:t.touches[0].clientX-n.left,y:t.touches[0].clientY-n.top}}function n(){s&&(a.moveTo(d.x,d.y),a.lineTo(o.x,o.y),a.stroke(),d=o)}window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimaitonFrame||function(e){window.setTimeout(e,1e3/60)};var i=document.getElementById("sig-canvas"),a=i.getContext("2d");a.strokeStyle="#BAAC9E",a.lineWidth=2;var s=!1,o={x:0,y:0},d=o;i.addEventListener("mousedown",function(t){s=!0,d=e(i,t)},{passive:!1}),i.addEventListener("mouseup",function(e){s=!1},{passive:!1}),i.addEventListener("mousemove",function(t){o=e(i,t)},{passive:!1}),i.addEventListener("touchstart",function(e){},{passive:!1}),i.addEventListener("touchmove",function(e){var t=e.touches[0],n=new MouseEvent("mousemove",{clientX:t.clientX,clientY:t.clientY});i.dispatchEvent(n)},{passive:!1}),i.addEventListener("touchstart",function(e){o=t(i,e);var n=e.touches[0],a=new MouseEvent("mousedown",{clientX:n.clientX,clientY:n.clientY});i.dispatchEvent(a)},{passive:!1}),i.addEventListener("touchend",function(e){var t=new MouseEvent("mouseup",{});i.dispatchEvent(t)},{passive:!1}),document.body.addEventListener("touchstart",function(e){e.target==i&&e.preventDefault()},{passive:!1}),document.body.addEventListener("touchend",function(e){e.target==i&&e.preventDefault()},{passive:!1}),document.body.addEventListener("touchmove",function(e){e.target==i&&e.preventDefault()},{passive:!1}),function e(){requestAnimFrame(e),n()}();var l=document.getElementById("clearCanvas");l.addEventListener("click",function(e){i.width=i.width,a.strokeStyle="#BAAC9E",a.lineWidth=2})}(),firebase.initializeApp({apiKey:"AIzaSyAKzR5AiJVZ3Iz5tJrWsLeBVDZJl2SSqLE",authDomain:"coronaprototyp.firebaseapp.com",databaseURL:"https://coronaprototyp.firebaseio.com",projectId:"coronaprototyp",storageBucket:"coronaprototyp.appspot.com",messagingSenderId:"857488715212",appId:"1:857488715212:web:763e73804d890e4bf40169"});
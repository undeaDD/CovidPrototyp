async function checkAndInsert(){var e=!0;const t=document.forms.main,n=[...t.elements];var a=n.reduce(function(t,n,a){return"date"==n.type?t[n.name]=n.valueAsDate.toLocaleDateString():""==n.value?n.classList.contains("required")&&(n.classList.add("is-invalid"),e=!1):(n.classList.remove("is-invalid"),t[n.name]=n.value),t},{});a.p1_telephone||a.p1_mobile||a.p1_fax||a.p1_email||(t.p1_telephone.classList.add("is-invalid"),e=!1);try{for(let e=1;e<6;e++){const n=t["p"+e+"_front"];n.files.length>0?a["p"+e+"_front"]=await readFile(n.files[0]):delete a["p"+e+"_front"];const i=t["p"+e+"_back"];i.files.length>0?a["p"+e+"_back"]=await readFile(i.files[0]):delete a["p"+e+"_back"]}}catch(e){}const i=document.getElementById("morePatients").selectedIndex;switch(i){case 3:delete a.p5_birthdate,delete a.p5_birthdate,delete a.p5_email_verify;break;case 2:delete a.p4_birthdate,delete a.p4_email_verify,delete a.p5_birthdate,delete a.p5_email_verify;break;case 1:delete a.p3_birthdate,delete a.p3_email_verify,delete a.p4_birthdate,delete a.p4_email_verify,delete a.p5_birthdate,delete a.p5_email_verify;break;default:a.morepatients="0",delete a.p2_birthdate,delete a.p2_email_verify,delete a.p3_birthdate,delete a.p3_email_verify,delete a.p4_birthdate,delete a.p4_email_verify,delete a.p5_birthdate,delete a.p5_email_verify}for(let n=1;n<6;n++)try{const i=a["p"+n+"_email_verify"];i&&(i!=a["p"+n+"_email"]?(t["p"+n+"_email_verify"].classList.add("is-invalid"),e=!1):delete a["p"+n+"_email_verify"])}catch(e){}if(t.invoice_enabled.checked?a.invoice_enabled=!0:a.invoice_enabled=!1,t.datenschutz.checked?a.datenschutz=!0:(a.datenschutz=!1,e=!1),a.signature=document.getElementById("sig-canvas").toDataURL(),a.insertDate=(new Date).toLocaleDateString(),a.OS=navigator.platform,e){const e=firebase.database().ref().child("requests").push().key;firebase.database().ref("requests/"+e).set(a),$("#successModal").modal("show"),parent.postMessage({type:"modal.close"},"*")}else $("#errorModal").modal("show")}async function readFile(e){return await new Promise(t=>{let n=new FileReader;n.onload=(e=>t(n.result)),n.readAsDataURL(e)})}function toggleRechnung(){document.getElementById("cardRechnung").classList.toggle("d-none"),document.getElementsByName("invoice_firstname")[0].classList.toggle("required"),document.getElementsByName("invoice_street")[0].classList.toggle("required"),document.getElementsByName("invoice_zip")[0].classList.toggle("required"),document.getElementsByName("invoice_address")[0].classList.toggle("required"),document.getElementsByName("invoice_email")[0].classList.toggle("required")}function configurePatient(e,t){e?(document.getElementById("patient"+t).classList.remove("d-none"),document.getElementsByName("p"+t+"_firstname")[0].classList.add("required"),document.getElementsByName("p"+t+"_lastname")[0].classList.add("required"),document.getElementsByName("p"+t+"_street")[0].classList.add("required"),document.getElementsByName("p"+t+"_zip")[0].classList.add("required"),document.getElementsByName("p"+t+"_address")[0].classList.add("required"),document.getElementsByName("p"+t+"_birthdate")[0].classList.add("required")):(document.getElementById("patient"+t).classList.add("d-none"),document.getElementsByName("p"+t+"_firstname")[0].classList.remove("required"),document.getElementsByName("p"+t+"_lastname")[0].classList.remove("required"),document.getElementsByName("p"+t+"_street")[0].classList.remove("required"),document.getElementsByName("p"+t+"_zip")[0].classList.remove("required"),document.getElementsByName("p"+t+"_address")[0].classList.remove("required"),document.getElementsByName("p"+t+"_birthdate")[0].classList.remove("required"))}function showPatients(){const e=document.getElementById("morePatients").selectedIndex;switch(configurePatient(!1,2),configurePatient(!1,3),configurePatient(!1,4),configurePatient(!1,5),e){case 4:configurePatient(!0,5);case 3:configurePatient(!0,4);case 2:configurePatient(!0,3);case 1:configurePatient(!0,2)}}function toggleCC(){document.getElementById("copyMail").classList.toggle("d-none"),document.getElementById("copyMail").classList.contains("d-none")?document.getElementById("copyMailButton").innerText="+":document.getElementById("copyMailButton").innerText="-"}function updateLabel(e){var t=e.target.files[0].name;null!=e.target.nextElementSibling&&(e.target.nextElementSibling.innerText=t)}function googleTranslateElementInit(){new google.translate.TranslateElement({pageLanguage:"de"},"google_translate_element"),jQuery(".goog-logo-link").css("display","none"),jQuery(".goog-te-gadget").css("font-size","0")}window.frameElement&&($("#headerNav").remove(),$("#footerNav").remove(),$("#cardImage").remove(),$("body").css("background","transparent")),window.addEventListener("resize",function(e){var t=document.getElementById("sig-canvas");t.width=t.offsetWidth});var canvas=document.getElementById("sig-canvas");canvas.width=canvas.offsetWidth,function(){function e(e,t){var n=e.getBoundingClientRect();return{x:t.clientX-n.left,y:t.clientY-n.top}}function t(e,t){var n=e.getBoundingClientRect();return{x:t.touches[0].clientX-n.left,y:t.touches[0].clientY-n.top}}function n(){s&&(i.moveTo(d.x,d.y),i.lineTo(o.x,o.y),i.stroke(),d=o)}window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimaitonFrame||function(e){window.setTimeout(e,1e3/60)};var a=document.getElementById("sig-canvas"),i=a.getContext("2d");i.strokeStyle="#BAAC9E",i.lineWidth=2;var s=!1,o={x:0,y:0},d=o;a.addEventListener("mousedown",function(t){s=!0,d=e(a,t)},{passive:!1}),a.addEventListener("mouseup",function(e){s=!1},{passive:!1}),a.addEventListener("mousemove",function(t){o=e(a,t)},{passive:!1}),a.addEventListener("touchstart",function(e){},{passive:!1}),a.addEventListener("touchmove",function(e){var t=e.touches[0],n=new MouseEvent("mousemove",{clientX:t.clientX,clientY:t.clientY});a.dispatchEvent(n)},{passive:!1}),a.addEventListener("touchstart",function(e){o=t(a,e);var n=e.touches[0],i=new MouseEvent("mousedown",{clientX:n.clientX,clientY:n.clientY});a.dispatchEvent(i)},{passive:!1}),a.addEventListener("touchend",function(e){var t=new MouseEvent("mouseup",{});a.dispatchEvent(t)},{passive:!1}),document.body.addEventListener("touchstart",function(e){e.target==a&&e.preventDefault()},{passive:!1}),document.body.addEventListener("touchend",function(e){e.target==a&&e.preventDefault()},{passive:!1}),document.body.addEventListener("touchmove",function(e){e.target==a&&e.preventDefault()},{passive:!1}),function e(){requestAnimFrame(e),n()}();var r=document.getElementById("clearCanvas");r.addEventListener("click",function(e){a.width=a.width,i.strokeStyle="#BAAC9E",i.lineWidth=2})}(),firebase.initializeApp({apiKey:"AIzaSyAKzR5AiJVZ3Iz5tJrWsLeBVDZJl2SSqLE",authDomain:"coronaprototyp.firebaseapp.com",databaseURL:"https://coronaprototyp.firebaseio.com",projectId:"coronaprototyp",storageBucket:"coronaprototyp.appspot.com",messagingSenderId:"857488715212",appId:"1:857488715212:web:763e73804d890e4bf40169"});